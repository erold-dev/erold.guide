---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getFrameworks, getGuidelinesByFramework } from '../../lib/content';

const frameworks = getFrameworks().map(fw => ({
  ...fw,
  guidelinesCount: getGuidelinesByFramework(fw.slug).length,
}));

const totalGuidelines = frameworks.reduce((sum, fw) => sum + fw.guidelinesCount, 0);
---

<BaseLayout title="Frameworks">
  <div class="mx-auto max-w-6xl px-4 py-12 sm:px-6">

    <!-- Header -->
    <div class="mb-12">
      <nav class="text-sm font-mono mb-4" style="color: var(--color-terminal-muted);">
        <a href="/" class="hover:text-[--color-primary-400] transition-colors">Home</a>
        <span class="mx-2">/</span>
        <span class="text-white">Frameworks</span>
      </nav>

      <h1 class="text-3xl font-bold text-white tracking-tight mb-3">Frameworks</h1>
      <p class="text-lg max-w-2xl" style="color: var(--color-terminal-muted);">
        Browse development guidelines organized by framework.
        Each framework contains categorized best practices and patterns.
      </p>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats mb-12">
      <div class="quick-stat">
        <span class="quick-stat-value">{frameworks.length}</span>
        <span class="quick-stat-label">Frameworks</span>
      </div>
      <div class="quick-stat-divider"></div>
      <div class="quick-stat">
        <span class="quick-stat-value">{totalGuidelines}</span>
        <span class="quick-stat-label">Total Guidelines</span>
      </div>
    </div>

    <!-- Framework Grid -->
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {frameworks.map((fw) => (
        <a href={`/frameworks/${fw.slug}`} class="framework-card">
          <div class="framework-card-header">
            <div class="framework-card-icon">
              {fw.logo ? (
                <img src={fw.logo} alt={fw.name} />
              ) : (
                <span class="text-xl font-bold text-white">{fw.name.charAt(0)}</span>
              )}
            </div>
            <div>
              <div class="framework-card-title">{fw.name}</div>
              <div class="framework-card-tech">{fw.technology}</div>
            </div>
          </div>

          <p class="framework-card-desc">{fw.description}</p>

          {fw.tags && fw.tags.length > 0 && (
            <div class="flex flex-wrap gap-1.5 mt-3">
              {fw.tags.slice(0, 3).map(tag => (
                <span class="tag text-xs">{tag}</span>
              ))}
            </div>
          )}

          <div class="framework-card-footer">
            <div class="framework-card-stat">
              <span class="framework-card-stat-value">{fw.guidelinesCount}</span>
              <span class="framework-card-stat-label">guidelines</span>
            </div>
            {fw.currentVersion && (
              <span class="text-xs font-mono px-2 py-1 rounded" style="background: var(--color-terminal-bg); color: var(--color-primary-400);">
                v{fw.currentVersion}
              </span>
            )}
          </div>
        </a>
      ))}
    </div>

    {frameworks.length === 0 && (
      <div class="empty-state">
        <div class="empty-state-icon">
          <svg class="w-8 h-8 text-[--color-terminal-muted]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
        </div>
        <div class="empty-state-title">No frameworks yet</div>
        <div class="empty-state-desc">
          Add framework YAML files to content/frameworks/ to get started.
        </div>
      </div>
    )}

  </div>
</BaseLayout>

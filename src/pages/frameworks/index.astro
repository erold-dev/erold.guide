---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getFrameworks, getGuidelinesByFramework } from '../../lib/content';

const frameworks = getFrameworks().map(fw => ({
  ...fw,
  guidelinesCount: getGuidelinesByFramework(fw.slug).length,
}));
---

<BaseLayout title="Frameworks">
  <div class="mx-auto max-w-6xl px-4 py-8 sm:px-6">
    <div class="mb-8 pb-6 border-b border-[--color-terminal-border]">
      <h1 class="text-2xl font-mono font-bold text-white mb-2">Frameworks</h1>
      <p class="font-mono text-sm" style="color: var(--color-terminal-muted);">
        Browse guidelines by framework. Each framework has categorized best practices.
      </p>
    </div>

    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {frameworks.map((fw) => (
        <a
          href={`/frameworks/${fw.slug}`}
          class="block p-4 rounded-lg transition-all hover:scale-[1.02]"
          style="background: var(--color-terminal-surface); border: 1px solid var(--color-terminal-border);"
        >
          <div class="flex items-start gap-3">
            {fw.logo && (
              <img
                src={fw.logo}
                alt={fw.name}
                class="w-10 h-10 rounded"
                style="filter: brightness(0) invert(1);"
              />
            )}
            <div class="flex-1 min-w-0">
              <h2 class="font-mono font-semibold text-white truncate">{fw.name}</h2>
              <p class="font-mono text-xs mt-1 line-clamp-2" style="color: var(--color-terminal-muted);">
                {fw.description}
              </p>
            </div>
          </div>
          <div class="flex items-center gap-4 mt-4 pt-3 border-t border-[--color-terminal-border]">
            <span class="font-mono text-xs" style="color: var(--color-terminal-muted);">
              {fw.guidelinesCount} guidelines
            </span>
            {fw.currentVersion && (
              <span class="font-mono text-xs px-2 py-0.5 rounded" style="background: var(--color-terminal-bg); color: var(--color-primary-400);">
                v{fw.currentVersion}
              </span>
            )}
          </div>
        </a>
      ))}
    </div>

    {frameworks.length === 0 && (
      <div class="text-center py-12">
        <p class="font-mono text-sm" style="color: var(--color-terminal-muted);">
          No frameworks found. Add framework YAML files to content/frameworks/
        </p>
      </div>
    )}
  </div>
</BaseLayout>
